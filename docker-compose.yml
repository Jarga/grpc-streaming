version: '3.7'
services:
  mongo:
    image: mongo
    #volumes:
    #  - ./data/mongo:/data/db
    ports: 
      - 27017:27017
  grpc-chat-sql:
    ports:
        - "1433:1433"
    image: grpc-chat-sql
    build: 
      context: ./sql
      dockerfile: "./grpc-chat/Dockerfile"
    restart: on-failure
    environment:
        - ACCEPT_EULA=Y
        - MSSQL_SA_PASSWORD=grpcstreaming!Rul3s
  grpc-video-sql:
    ports:
        - "1434:1433"
    image: grpc-video-sql
    build: 
      context: ./sql
      dockerfile: "./grpc-video/Dockerfile"
    restart: on-failure
    environment:
        - ACCEPT_EULA=Y
        - MSSQL_SA_PASSWORD=grpcstreaming!Rul3s
  redis:
    ports:
        - "6379:6379"
    image: redis:alpine
    restart: on-failure